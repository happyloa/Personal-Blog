---
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'posts'>;
}

const { post } = Astro.props;
const formattedDate = post.data.date
  ? new Date(post.data.date).toLocaleDateString('zh-TW', { year: 'numeric', month: 'short', day: 'numeric' })
  : '未設定日期';
const summary =
  post.data.description ??
  post.body
    .split('\n')
    .find((line) => line.trim())
    ?.replace(/[#*>`]/g, '')
    ?.slice(0, 160) ?? '';
---
<article class="group rounded-2xl border border-white/10 bg-white/5 p-6 shadow-lg shadow-black/20 backdrop-blur transition hover:border-sky-400/40 hover:-translate-y-0.5">
  <div class="flex items-center justify-between text-xs text-slate-300">
    <span>{formattedDate}</span>
    {post.data.tags.length ? (
      <div class="flex flex-wrap gap-2">
        {post.data.tags.map((tag) => (
          <span class="tag-pill">#{tag}</span>
        ))}
      </div>
    ) : null}
  </div>
  <h2 class="mt-3 text-xl font-semibold text-white group-hover:text-sky-100">
    <a href={`/posts/${post.slug}/`} class="no-underline">{post.data.title}</a>
  </h2>
  {summary && <p class="mt-3 text-sm text-slate-200 leading-relaxed">{summary}</p>}
  <div class="mt-4 inline-flex items-center gap-2 text-sky-300 text-sm">
    閱讀全文
    <svg class="size-4 transition-transform group-hover:translate-x-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14m-6-6 6 6-6 6" />
    </svg>
  </div>
</article>
